{% extends "base.html" %}
{% block title %}Coach Dashboard{% endblock %}
{% block pre_main %}
  {% include "partials/page_header.html" with title="Coach Dashboard" description="Manage your training sessions and view enrollments." %}
{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      <div class="card-body text-center">
        <h5 class="card-title">Profile</h5>
        <p class="card-text">{{ profile.first_name }} {{ profile.last_name }}</p>
        <p class="text-muted">{{ profile.sport_type }} - {{ profile.level }}</p>
        <a href="{% url 'coaches:profile' %}" class="btn btn-outline-primary btn-sm">Edit Profile</a>
      </div>
    </div>
  </div>

  <div class="col-md-8 mb-4">
    <div class="card h-100">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Upcoming Sessions</h5>
        <a href="{% url 'coaches:sessions' %}" class="btn btn-sm btn-outline-primary">View All</a>
      </div>
      <div class="card-body">
        {% if sessions %}
        <div class="list-group list-group-flush">
          {% for session in sessions %}
          <a href="{% url 'coaches:session_detail' session.pk %}" class="list-group-item list-group-item-action">
            <div class="d-flex w-100 justify-content-between">
              <h6 class="mb-1">{{ session.reservation.facility.facility_name }}</h6>
              <small>{{ session.reservation.reservation_date }}</small>
            </div>
            <p class="mb-1">{{ session.reservation.start_time }} - {{ session.reservation.end_time }}</p>
            <small>Capacity: {{ session.max_capacity }}</small>
          </a>
          {% endfor %}
        </div>
        {% else %}
        <p class="text-muted">No upcoming sessions scheduled.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-12 mb-4">
    <div class="card h-100">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Visitor Applications (read-only)</h5>
        <a href="{% url 'coaches:visitor_applications' %}" class="btn btn-sm btn-outline-secondary">View all</a>
      </div>
      <div class="card-body">
        {% if visitor_applications %}
        <div class="list-group list-group-flush">
          {% for application in visitor_applications %}
          <a href="{% url 'coaches:visitor_application_detail' application.pk %}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            <div>
              <div class="fw-semibold">{{ application.first_name }} {{ application.last_name }}</div>
              <small class="text-muted">Applied on {{ application.application_date }}</small>
            </div>
            <span
              class="badge {% if application.status == 'Approved' %}bg-success{% elif application.status == 'Rejected' %}bg-danger{% else %}bg-warning text-dark{% endif %}">
              {{ application.get_status_display }}
            </span>
          </a>
          {% endfor %}
        </div>
        {% else %}
        <p class="text-muted mb-0">No visitor applications to display.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
